<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self';
               script-src 'self' https://cdn.jsdelivr.net;
               style-src 'self' https://rsms.me;
               img-src 'self' data:;
               font-src https://rsms.me;
               connect-src 'self' https://cdn.jsdelivr.net;
               worker-src 'self';
               object-src 'none';
               base-uri 'self';
               upgrade-insecure-requests"
    />
    <meta name="referrer" content="no-referrer" />
    <title>Copilot Dashboard v2</title>
    <link rel="icon" href="data:," />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="stylesheet"
      href="https://rsms.me/inter/inter.css"
      crossorigin="anonymous"
      integrity="sha384-STiTZ2kjdnc/em4jSELZZ6VypRToc92cA0m6Nppx3J8C4mt0fjMNUm1xnm1yoP96"
    />
    <link rel="stylesheet" href="assets/copilot-dashboard.css?v=20251227-v2-1" />
    <script
      src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"
      crossorigin="anonymous"
      integrity="sha384-D/t0ZMqQW31H3az8ktEiNb39wyKnS82iFY52QPACM+IjKW3jDUhyIgh2PApRqJZs"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"
      crossorigin="anonymous"
      integrity="sha384-vsrfeLOOY6KuIYKDlmVH5UiBmgIdB1oEf7p01YgWHuqmOHfZr374+odEv96n9tNC"
    ></script>
  </head>
  <body class="is-light-base">
    <button
      type="button"
      class="floating-theme-toggle"
      data-theme-toggle
      aria-pressed="false"
      aria-label="Enable dark mode"
    >
      <span aria-hidden="true" data-theme-icon></span>
    </button>

    <a href="#main" class="skip-link">Skip to main content</a>
    <div class="toast-container" data-toast-container></div>
    <div class="sticky-filter-bar" data-sticky-filter-bar hidden>
      <span class="sticky-filter-bar__label">Filters</span>
      <span class="sticky-filter-bar__summary" data-sticky-filter-summary></span>
      <button type="button" class="sticky-filter-bar__btn" data-sticky-filter-btn>Show filters &#9660;</button>
      <div class="sticky-filter-dropdown" data-sticky-filter-dropdown hidden></div>
    </div>

    <main id="main">
      <header class="page-header">
        <article class="intro-card">
          <div class="intro-header">
            <span class="dashboard-pill">Viva Copilot Dashboard</span>
            <p class="intro">
              Copilot Dashboard v2: analyze the Viva Copilot Dashboard CSV export locally in your browser.
            </p>
            <div class="v2-theme-picker">
              <label class="v2-control__label" for="themeSelect">Theme</label>
              <select id="themeSelect" class="control-select" data-theme-select></select>
            </div>
          </div>

          <div class="upload-zone" data-drop-zone role="region" aria-label="File upload area">
            <input type="file" accept=".csv" data-file-input hidden aria-describedby="uploadHint" />
            <div class="upload-actions">
              <div class="upload-buttons">
                <button type="button" class="upload-button" data-pick-file>Select CSV file</button>
                <button type="button" class="upload-button upload-button--ghost" data-load-sample>Load sample</button>
              </div>
              <span class="upload-hint muted" id="uploadHint">or drop the file anywhere in this panel</span>
            </div>

            <div class="upload-progress" data-upload-progress hidden>
              <progress class="upload-progress__bar" value="0" max="100" data-upload-progress-bar></progress>
              <button type="button" class="upload-cancel" data-upload-cancel>Cancel import</button>
            </div>

            <p class="upload-meta" data-upload-meta>No file chosen yet.</p>
          </div>

          <div class="upload-status" role="status" aria-live="polite">
            <p class="muted" data-upload-status>Upload a CSV to begin.</p>
            <div class="muted" data-schema-summary hidden></div>
            <div class="muted" data-schema-warnings hidden></div>
          </div>
        </article>
        <aside class="dataset-card" role="complementary" aria-label="Dataset information">
          <h2>Dataset status</h2>
          <p class="muted" data-dataset-message>Load a CSV export to unlock the dashboard.</p>
          <div class="dataset-meta-grid" data-dataset-meta hidden>
            <div class="meta-item">
              <span class="muted">Records processed</span>
              <strong data-meta-records>0</strong>
            </div>
            <div class="meta-item">
              <span class="muted">Unique users</span>
              <strong data-meta-users>0</strong>
            </div>
            <div class="meta-item">
              <span class="muted">Date range</span>
              <strong data-meta-dates>-</strong>
            </div>
            <div class="meta-item">
              <span class="muted">Metrics</span>
              <strong data-meta-metrics>0</strong>
            </div>
            <div class="meta-item">
              <span class="muted">Filtered out</span>
              <strong data-meta-filtered>0</strong>
            </div>
          </div>
        </aside>
      </header>

      <div class="page-body">
        <section class="card" aria-labelledby="filtersTitle" data-filters-card hidden>
          <div class="card-header-with-actions">
            <div>
              <h2 class="card-title" id="filtersTitle">Filters</h2>
              <div class="active-filters-summary" data-active-filters-summary hidden>
                <div class="active-filters-header">
                  <span class="active-filters-label">Active filters</span>
                  <button type="button" class="clear-all-filters" data-clear-all-filters>Clear all</button>
                </div>
                <div class="active-filters-list" data-active-filters-list></div>
              </div>
            </div>
            <div class="card-header-actions">
              <button type="button" class="upload-button upload-button--ghost" data-export-summary>Download summary (CSV)</button>
              <div class="export-controls" data-export-controls aria-label="Export">
                <button
                  type="button"
                  class="export-trigger"
                  data-export-trigger
                  aria-haspopup="true"
                  aria-expanded="false"
                >
                  Export &#9660;
                </button>
                <div class="export-menu" data-export-menu hidden role="menu">
                  <button type="button" data-export-summary-menu role="menuitem">Download summary (CSV)</button>
                  <button type="button" data-export-trend-menu role="menuitem">Download trend (PNG)</button>
                  <button type="button" data-export-workload-menu role="menuitem">Download workload (PNG)</button>
                  <button type="button" data-export-dimtrend-menu role="menuitem">Download top dimensions (PNG)</button>
                  <button type="button" data-export-breakdown-menu role="menuitem">Download top breakdown (PNG)</button>
                </div>
              </div>
            </div>
          </div>
          <div class="filter-grid" data-filters-grid></div>
        </section>

        <section class="card" aria-labelledby="summaryTitle" data-summary-card hidden>
          <div class="card-header">
            <h2 class="card-title" id="summaryTitle">Summary</h2>
          </div>
          <div class="card-grid" data-summary-grid></div>
        </section>

        <section class="card" aria-labelledby="trendTitle" data-trend-card hidden>
          <div class="card-header-with-actions">
            <h2 class="card-title" id="trendTitle">Trend</h2>
            <div class="card-header-actions">
              <button type="button" class="upload-button upload-button--ghost" data-export-trend-png>Download PNG</button>
            </div>
          </div>
          <p class="muted" data-trend-empty hidden>No data for the selected metric and date range.</p>
          <div class="chart-actions" data-trend-controls>
            <div class="trend-view-toggle" role="group" aria-label="Trend mode">
              <button type="button" class="trend-view-button is-active" data-trend-mode="metric" aria-pressed="true">
                Selected metric
              </button>
              <button type="button" class="trend-view-button" data-trend-mode="workloadActions" aria-pressed="false">
                Apps (actions)
              </button>
              <button type="button" class="trend-view-button" data-trend-mode="workloadActiveDays" aria-pressed="false">
                Apps (active days)
              </button>
            </div>
            <div class="series-toggle-rail" data-series-toggle-group aria-label="Series visibility"></div>
          </div>
          <div class="chart-card">
            <canvas data-trend-chart aria-label="Trend chart" role="img"></canvas>
          </div>
        </section>

        <section class="card" aria-labelledby="workloadTitle" data-workload-card hidden>
          <div class="card-header-with-actions">
            <h2 class="card-title" id="workloadTitle">Workload breakdown</h2>
            <div class="card-header-actions">
              <div class="v2-workload-controls">
                <label class="v2-control__label" for="workloadMode">Mode</label>
                <select id="workloadMode" class="control-select" data-workload-mode></select>
              </div>
              <button type="button" class="upload-button upload-button--ghost" data-export-workload-png>Download PNG</button>
            </div>
          </div>
          <p class="muted">
            Aggregated from “actions taken in …” / “days of active usage in …” / “enabled days for …” columns when present.
          </p>
          <div class="chart-card">
            <canvas data-workload-chart aria-label="Workload breakdown chart" role="img"></canvas>
          </div>
          <div class="table-card">
            <table class="data-table">
              <thead>
                <tr>
                  <th scope="col">Workload</th>
                  <th scope="col">Value</th>
                </tr>
              </thead>
              <tbody data-workload-body></tbody>
            </table>
          </div>
          <p class="muted" data-workload-empty hidden>No workload-specific columns found for this mode.</p>
        </section>

        <section class="card" aria-labelledby="dimensionTrendTitle" data-dimension-trend-card hidden>
          <div class="card-header-with-actions">
            <h2 class="card-title" id="dimensionTrendTitle">Top dimensions trend</h2>
            <div class="card-header-actions">
              <button type="button" class="upload-button upload-button--ghost" data-export-dimtrend-png>Download PNG</button>
            </div>
          </div>
          <p class="muted">
            Available for core metrics (Total Copilot actions/active days/enabled days).
          </p>
          <div class="chart-card">
            <canvas data-dimension-trend-chart aria-label="Top dimensions trend chart" role="img"></canvas>
          </div>
        </section>

        <section class="card" aria-labelledby="topTitle" data-top-card hidden>
          <div class="card-header-with-actions">
            <h2 class="card-title" id="topTitle">Top breakdown</h2>
            <div class="card-header-actions">
              <button type="button" class="upload-button upload-button--ghost" data-export-breakdown-png>Download PNG</button>
            </div>
          </div>
          <p class="muted" data-top-empty hidden>No data for the selected dimension/metric.</p>
          <div class="chart-card">
            <canvas data-breakdown-chart aria-label="Top breakdown bar chart" role="img"></canvas>
          </div>
          <div class="table-card">
            <table class="data-table">
              <thead>
                <tr>
                  <th scope="col" data-top-dimension-header></th>
                  <th scope="col">Value</th>
                </tr>
              </thead>
              <tbody data-top-body></tbody>
            </table>
          </div>
        </section>

        <section class="card" aria-labelledby="metricsTitle" data-metrics-card hidden>
          <div class="card-header">
            <h2 class="card-title" id="metricsTitle">Metrics</h2>
            <div class="v2-metric-search">
              <label class="v2-control__label" for="metricSearch">Search</label>
              <input id="metricSearch" class="control-input" type="search" placeholder="Find a metric…" data-metric-search />
            </div>
          </div>
          <div class="table-card">
            <table class="data-table">
              <thead>
                <tr>
                  <th scope="col">Group</th>
                  <th scope="col">Metric</th>
                  <th scope="col">Total</th>
                </tr>
              </thead>
              <tbody data-metrics-body></tbody>
            </table>
          </div>
        </section>
      </div>
    </main>

    <footer class="page-footer">
      <p class="muted">Copilot Dashboard v2 · Local-only processing.</p>
    </footer>

    <script defer src="assets/copilot-dashboard-v2.js?v=20251227-v2-1"></script>
  </body>
</html>
